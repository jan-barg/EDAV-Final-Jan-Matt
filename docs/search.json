[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Economic Growth and the Shrinking Family: A Cross-Country Exploration",
    "section": "",
    "text": "1 Introduction\nGlobally, birth rates have fallen to record lows, raising questions about how economic growth and prosperity shapes population trends. We were drawn to this topic because it sits at the intersection of economics and human behavior, how peopleâ€™s choices about family size might shift as societies become wealthier, more urban, and more educated. The idea of a â€œfertility collapseâ€ is more than a simple demographic story; it has deep implications for labor markets, social systems, and long-term economic stability. By looking at how economic growth and fertility rates move together or apart across time and regions, we hope to better understand what drives these changes in population dynamics, and if there are any countries towards which we can look for in hopes of finding a reversal strategy.",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "2Â  Data",
    "section": "",
    "text": "2.1 Description\nOur data will come from the Federal Reserve Bank of St.Â Louisâ€™s FRED (Federal Reserve Economic Data) database. FRED compiles and maintains a wide range of economic and demographic indicators collected by government agencies and international organizations such as the World Bank, IMF, and OECD. The data are reported in structured time series format, usually at monthly, quarterly, or annual frequencies depending on the indicator. Each series includes detailed metadata on measurement units, coverage, and source methodology. For our project, we plan to use country-level data on fertility rates and economic growth indicators. One challenge we might face is that the time ranges and reporting frequencies can differ across datasets, which may require some cleaning and alignment before analysis. Since there is no multi-country dataset that covers all the nations weâ€™re interested in, we will write a python script that downloads each investigated countryâ€™s data via API and then compiles a master dataset to work with. Here are example datasets for the United States of America that we would use. Many of these are available for multiple countries, hence we would scrape the same datasets, with identical units of measure, for multiple countries.\nFertility Rate â€” FRED Series This data set is specifically from the World Bank. It is a time series dataset for the fertility rate in the United States as Births Per Woman from 1960 to 2023.\nConstant GDP Per Capita â€” FRED Series This data set is comes from the World Bank. It is a time series dataset of the GDP per capita for the US from 1960 to 2025.\nEmployment-to-Population Ratio â€” FRED Series This data set is from the World Bank. It is a time series dataset that shows the employment rate to population ratio as a percentage.\nFemale Labor Force Participation Rate (Ages 15+) â€” World Bank Indicator This dataset comes from the World Bank, and it measures the percentage of women ages 15 and older who are part of the labor forceâ€”that is, women who are either employed or actively seeking employment. It provides insight into female engagement in the economy and helps assess how social, economic, and policy factors influence gender participation in the workforce. The data are reported annually and are available for most countries beginning in 1990.\nGini Index â€” FRED Series This data comes from the World Bank. The Gini index measures income inequality by calculating the area between the Lorenz curve and the line of perfect equality, where 0 represents perfect equality and 100 represents perfect inequality.\nTotal Population â€” FRED Series This data, sourced from the World Bank, shows the countryâ€™s total population. It might be useful in investigating whether immigration policies compensate for below-replacement birthrates.\nNet Migration â€” World Bank Indicator This data set comes from the World Bank and measures the net migration rate, defined as the difference between the number of immigrants and the number of emigrants for a country over a course of a year. Positive values indicate that more people are entering the country than leaving, while negative values indicate net emigration. This variable is particularly relevant for our analysis, as migration inflows can offset demographic decline caused by falling fertility rates. We also plan to examine possible lag effects between changes in migration and subsequent shifts in population growth.",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#data-collection-plan",
    "href": "data.html#data-collection-plan",
    "title": "2Â  Data",
    "section": "2.2 Data Collection Plan",
    "text": "2.2 Data Collection Plan\nFor the data collection, we will scrape data for selected countries and then assess data completeness, as the datasets vary in their time scope from country to country. Once we evaluate missing data, we aim to address the following questions:\n\nCountry Selection: Which countries provide a holistic overview of birth rates and their correlations with our selected economic and social indicators?\nTimeframe Selection: What timeframe allows us to gain valuable insights without having to impute a significant portion of the data (since heavy imputation could introduce inaccuracies)?\nHandling Missing Data: How should we address missing values while preserving accuracy and comparability to the highest extent possible?\n\nOur plan is to first compile the raw datasets via API (using Python) for each indicator and country, merge them into a master dataset, and then perform exploratory analysis on the combined and cleaned data.",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#country-selection",
    "href": "data.html#country-selection",
    "title": "2Â  Data",
    "section": "2.3 Country Selection",
    "text": "2.3 Country Selection\nTo gain a holistic global overview of the declining birthrate problem, we decided to focus on 13 countries, spanning all 7 continents, with varying GDP per capita levels. The investigated countries range from highly populated developing economies (e.g.Â India) to aging advanced economies (e.g.Â South Korea), and span different stages of demographic transition - from high fertility (Nigeria) to very low fertility (Japan).\nThe final country selection is structured as follows:\n\n\n\n\n\n\n\n\nRegion\nCountry\nRationale\n\n\n\n\nNorth America\nUnited States ğŸ‡ºğŸ‡¸Canada ğŸ‡¨ğŸ‡¦\nAdvanced economies with stable but below-replacement fertility; strong immigration inflows sustain population growth.\n\n\nEurope\nGermany ğŸ‡©ğŸ‡ªSweden ğŸ‡¸ğŸ‡ªPoland ğŸ‡µğŸ‡±\nContrasting European cases: Western vs.Â Central; differing immigration policies, labor structures, and fertility recovery trends.\n\n\nAsia\nIndia ğŸ‡®ğŸ‡³China ğŸ‡¨ğŸ‡³Japan ğŸ‡¯ğŸ‡µSouth Korea ğŸ‡°ğŸ‡·\nBroad spectrum of development and demographic stages, from rapid growth to severe aging and fertility decline.\n\n\nAfrica\nNigeria ğŸ‡³ğŸ‡¬South Africa ğŸ‡¿ğŸ‡¦\nHigh-fertility versus mid-transition economies; provide insight into the early stages of demographic transition.\n\n\nSouth America\nBrazil ğŸ‡§ğŸ‡·\nEmerging economy experiencing a steady decline in fertility while maintaining moderate population growth.\n\n\nOceania\nAustralia ğŸ‡¦ğŸ‡º\nImmigration-driven growth with below-replacement fertility; valuable case for lag analysis between migration and population stabilization.\n\n\n\n\n\nCode\nselected_countries &lt;- c(\n  \"United States of America\",\n  \"Canada\",\n  \"Germany\",\n  \"Sweden\",\n  \"Poland\",\n  \"India\",\n  \"China\",\n  \"Japan\",\n  \"South Korea\",\n  \"Nigeria\",\n  \"South Africa\",\n  \"Brazil\",\n  \"Australia\"\n)\n\nlibrary(sf)\nlibrary(rnaturalearth)\nlibrary(ggplot2)\nlibrary(dplyr)\n\nworld &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\")\n\nworld &lt;- world %&gt;%\n  mutate(\n    selected = ifelse(admin %in% selected_countries, \"Selected\", \"Not Selected\")\n  )\n\nggplot(world) +\n  geom_sf(aes(fill = selected), color = \"white\", size = 0.2) +\n  scale_fill_manual(values = c(\"Selected\" = \"#2c7fb8\", \"Not Selected\" = \"gray85\")) +\n  theme_minimal() +\n  labs(\n    title = \"Countries Selected for Analysis\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    plot.title = element_text(size = 18, face = \"bold\")\n  )",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#data-collection",
    "href": "data.html#data-collection",
    "title": "2Â  Data",
    "section": "2.4 Data Collection",
    "text": "2.4 Data Collection\nThe data collection was done using API calls to the FRED and World Bank databases, using a python script, available here. The script created master-wide and master-long datasets, which will be used as the backbone of this project.",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#date-range-selection",
    "href": "data.html#date-range-selection",
    "title": "2Â  Data",
    "section": "2.5 Date Range Selection",
    "text": "2.5 Date Range Selection\n\n\nCode\n# Load once\nmaster_long &lt;- read_csv(file_path, show_col_types = FALSE) |&gt;\n  mutate(\n    year  = as.integer(year),\n    value = suppressWarnings(as.numeric(value))\n  )\n\n# Coverage by first/last non-missing\nmissing_summary &lt;- master_long |&gt;\n  group_by(country, variable) |&gt;\n  reframe({\n    yrs_nonmiss &lt;- year[is.finite(value) & !is.na(value)]\n    out &lt;- compute_year_gaps(yrs_nonmiss)\n    tibble(\n      first_non_missing_year = out$first_non_missing_year,\n      last_non_missing_year  = out$last_non_missing_year,\n      total_years_in_range   = out$total_years_in_range,\n      years_present          = out$years_present,\n      years_missing          = out$years_missing,\n      pct_years_missing      = out$pct_years_missing\n    )\n  }) |&gt;\n  ungroup() |&gt;\n  mutate(\n    date_range = ifelse(\n      is.na(first_non_missing_year) | is.na(last_non_missing_year),\n      NA_character_,\n      paste0(first_non_missing_year, \"â€“\", last_non_missing_year)\n    )\n  ) |&gt;\n  arrange(country, variable)\n\n\n\n\nCode\ncoverage_table &lt;- missing_summary |&gt;\n  mutate(\n    coverage = ifelse(\n      is.na(first_non_missing_year) | is.na(last_non_missing_year),\n      \"â€”\",\n      paste0(first_non_missing_year, \"â€“\", last_non_missing_year)\n    )\n  ) |&gt;\n  select(country, variable, coverage) |&gt;\n  pivot_wider(names_from = variable, values_from = coverage) |&gt;\n  arrange(country) |&gt;\n  rename(\n    `Country` = country,\n    `Employment-to-Population Ratio` = emp_to_pop,\n    `Fertility Rate` = fertility_rate,\n    `Female Labor Force Participation` = flfpr,\n    `GDP per Capita (constant)` = gdp_capita_const,\n    `Gini Index` = gini_index,\n    `Net Migration` = net_migration,\n    `Total Population` = total_population\n  )\n\ncoverage_table |&gt;\n  gt() |&gt;\n  tab_header(\n    title = \"Coverage Range by Country and Variable\",\n    subtitle = \"Each cell shows the first and last available year\"\n  ) |&gt;\n  cols_label(\n    `Employment-to-Population Ratio` = \"Emp-to-Pop\",\n    `Fertility Rate` = \"Fertility\",\n    `Female Labor Force Participation` = \"FLFPR\",\n    `GDP per Capita (constant)` = \"GDP (const)\",\n    `Gini Index` = \"Gini\",\n    `Net Migration` = \"Migration\",\n    `Total Population` = \"Population\"\n  ) |&gt;\n  opt_table_font(font = \"Arial\") |&gt;\n  opt_all_caps() |&gt;\n  opt_table_lines()\n\n\n\n\n\n\n\n\nCoverage Range by Country and Variable\n\n\nEach cell shows the first and last available year\n\n\nCountry\nEmp-to-Pop\nFertility\nFLFPR\nGDP (const)\nGini\nMigration\nPopulation\n\n\n\n\nAUS\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2024\n1981â€“2020\n1960â€“2024\n1960â€“2024\n\n\nBRA\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2024\n1981â€“2023\n1960â€“2024\n1960â€“2024\n\n\nCAN\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2024\n1971â€“2021\n1960â€“2024\n1960â€“2024\n\n\nCHN\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2024\n1981â€“2022\n1960â€“2024\n1960â€“2024\n\n\nDEU\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2024\n1991â€“2020\n1960â€“2024\n1960â€“2024\n\n\nIND\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2024\n1977â€“2022\n1960â€“2024\n1960â€“2024\n\n\nJPN\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2024\n2008â€“2020\n1960â€“2024\n1960â€“2024\n\n\nKOR\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2023\n2006â€“2021\n1960â€“2024\n1960â€“2024\n\n\nNGA\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2024\n1985â€“2022\n1960â€“2024\n1960â€“2024\n\n\nPOL\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1990â€“2024\n1985â€“2023\n1960â€“2024\n1960â€“2024\n\n\nSWE\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2024\n1975â€“2023\n1960â€“2024\n1960â€“2024\n\n\nUSA\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2024\n1963â€“2023\n1960â€“2024\n1960â€“2024\n\n\nZAF\n1991â€“2024\n1960â€“2023\n1990â€“2024\n1960â€“2024\n1993â€“2014\n1960â€“2024\n1960â€“2024\n\n\n\n\n\n\n\nAs shown by the data coverage table, the data differ in years covered across variables and countries. While certain variables (Fertility Rate, Net Migration, Total Population) span over 60 years for each country, others (most notably, Gini Index), have significantly shorter spans - for example, Japanâ€™s Gini Index is only known for the 2008-2020 range.\nWhile 1960 is the first year of recorded observations for Fertility Rate, GDP per Capita, Net Migration, and Total Population, OECD indeces (Employment-to-Population Ratio and Female Labor Force Participation) are available starting from 1991 and 1990, respectively.\nConsidering these date ranges across countries and variables, we can explore the interactions between long-spanning variables as the primary part of this investigation, using Employment-to-Population ratio, Female Labor Force Participation Rate, and Gini Index as auxillary variables to contextualize and enrich the analysis where their data is available. With this hybrid approach, we can maximize both temporal coverage and analytical depth, enabling broad trend analysis while still leveraging the socio-economic context captured by shorter-range indicators.\nConsidering that almost all variables cover data up to 2023, we decide to cap our exploration at 2023, and stick to the following date ranges for:\n\n1960â€“2023 for Fertiity Rate, Constant GDP Per Capita, Net Migration, and Total Population\n1991â€“2023 for Employment-to-Population Ratio, Female Labor Force Participation Rate, and Gini Index",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2Â  Data",
    "section": "2.6 Missing value analysis",
    "text": "2.6 Missing value analysis\nWith the aforementioned date ranges in mind, we can proceed to analyzing missing values, for each variable, in its respective timespan.\n\n\nCode\nrange_filtered_data &lt;- master_long |&gt;\n  inner_join(var_start_years, by = \"variable\") |&gt;\n  filter(year &gt;= start_year, year &lt;= end_year) |&gt;\n  select(country, year, variable, value) |&gt;\n  arrange(country, variable, year)\n\n# (optional) quick check\n# range_filtered_data |&gt;\n#   group_by(variable) |&gt;\n#   summarise(min_year = min(year), max_year = max(year), .groups = \"drop\")\n\n\n\n\nCode\nmissing_summary_window &lt;- range_filtered_data |&gt;\n  inner_join(var_start_years, by = \"variable\") |&gt;\n  group_by(country, variable, start_year) |&gt;\n  summarise(\n    years_present = n_distinct(year[is.finite(value) & !is.na(value)]),\n    .groups = \"drop_last\"\n  ) |&gt;\n  mutate(\n    end_year           = end_year,\n    total_years_window = end_year - start_year + 1L,\n    years_missing      = total_years_window - years_present,\n    pct_years_missing  = years_missing / total_years_window,\n    date_range         = paste0(start_year, \"â€“\", end_year)\n  ) |&gt;\n  ungroup() |&gt;\n  arrange(country, variable)\n\n# Aggregated view by variable\nmissing_by_variable &lt;- missing_summary_window |&gt;\n  group_by(variable) |&gt;\n  summarise(\n    countries_with_missing = sum(pct_years_missing &gt; 0, na.rm = TRUE),\n    mean_pct_missing       = mean(pct_years_missing, na.rm = TRUE),\n    max_pct_missing        = max(pct_years_missing, na.rm = TRUE),\n    .groups = \"drop\"\n  ) |&gt;\n  arrange(desc(mean_pct_missing))\n\n# Heatmap with labels on missing cells\nplot_df &lt;- missing_summary_window |&gt;\n  select(country, variable, pct_years_missing) |&gt;\n  complete(country, variable, fill = list(pct_years_missing = 0)) |&gt;\n  mutate(\n    variable = fct_reorder(variable, pct_years_missing, .fun = mean, .desc = TRUE),\n    country  = fct_reorder(country,  pct_years_missing, .fun = mean, .desc = TRUE)\n  )\n\nggplot(plot_df, aes(x = variable, y = country, fill = pct_years_missing)) +\n  geom_tile(color = \"grey90\", linewidth = 0.3) +\n  geom_text(\n    data = subset(plot_df, pct_years_missing &gt; 0),\n    aes(label = paste0(round(pct_years_missing * 100, 1), \"%\")),\n    color = \"black\", size = 3\n  ) +\n  scale_fill_gradient(\n    limits = c(0, 1),\n    labels = percent,\n    name = \"% Missing (within window)\",\n    low = \"white\", high = \"firebrick\"\n  ) +\n  labs(\n    title = \"Missing coverage by country and variable (date window-aware)\",\n    x = \"Variable\",\n    y = \"Country\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    axis.text.x = element_text(angle = 40, hjust = 1),\n    panel.grid = element_blank()\n  )\n\n\n\n\n\n\n\n\n\nWe see that we are missing significant proportions of Gini Index values for most countries in the covered range. With &gt;40% missing, these are essentially incomputable and not viable for statistical analysis in combination with the other variables. Thus, we can treat the Gini Index as an extra variable that serves a contextual and interpretive role rather than a primary analytical one. It can be used to illustrate patterns or disparities in income inequality where data is available, but it should not be included in quantitative analyses or cross-variable comparisons due to its inconsistent coverage.\n\n\nCode\ngini_start &lt;- 1991L\ngini_end   &lt;- 2023L\n\ngini_countries &lt;- range_filtered_data |&gt;\n  filter(variable == \"gini_index\") |&gt;\n  distinct(country)\n\ngini_grid &lt;- gini_countries |&gt;\n  crossing(year = gini_start:gini_end)\n\ngini_long &lt;- gini_grid |&gt;\n  left_join(\n    range_filtered_data |&gt;\n      filter(variable == \"gini_index\") |&gt;\n      transmute(country, year, value = as.numeric(value)),\n    by = c(\"country\", \"year\")\n  ) |&gt;\n  mutate(present = ifelse(is.finite(value) & !is.na(value), \"Present\", \"Missing\"))\n\ngini_order &lt;- gini_long |&gt;\n  group_by(country) |&gt;\n  summarise(pct_missing = mean(present == \"Missing\"), .groups = \"drop\") |&gt;\n  arrange(desc(pct_missing))\n\ngini_long &lt;- gini_long |&gt;\n  mutate(country = factor(country, levels = gini_order$country))\n\nggplot(gini_long, aes(x = year, y = country, fill = present)) +\n  geom_tile(color = \"white\", linewidth = 0.15) +\n  scale_x_continuous(breaks = seq(gini_start, gini_end, by = 4)) +\n  scale_fill_manual(values = c(Missing = \"grey85\", Present = \"steelblue\")) +\n  labs(\n    title = \"Gini Index availability by country and year\",\n    subtitle = \"Window: 1991â€“2023 (blue = data present, gray = missing)\",\n    x = \"Year\", y = \"Country\", fill = NULL\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    panel.grid = element_blank(),\n    axis.text.x = element_text(angle = 40, hjust = 1)\n  )\n\n\n\n\n\n\n\n\n\nOne more problem that we can observe in the data missingness table is the fact that 46.9% of the data between 1960 and 2023 is missing for GDP per Capita in Poland. Polandâ€™s GDP data was only reliably reported after 1989, when the communist regime fell in the country. Thus, historical GDP data prior to the early 1990s is often incomplete or unavailable due to differences in accounting standards, data collection methods, and limited integration with international databases such as the World Bank. Therefore, for Poland, we will retain this gap rather than imputing values to preserve data consistency across sources.\n\n\nCode\npol_gdp &lt;- master_long |&gt;\n  filter(country == \"POL\", variable == \"gdp_capita_const\") |&gt;\n  transmute(year = as.integer(year),\n            value = suppressWarnings(as.numeric(value)))\n\nfull &lt;- tibble(year = 1960:2023) |&gt;\n  left_join(pol_gdp, by = \"year\") |&gt;\n  arrange(year) |&gt;\n  mutate(is_missing = is.na(value) | !is.finite(value))\n\n# contiguous missing spans for shading\nr &lt;- rle(full$is_missing)\nends   &lt;- cumsum(r$lengths)\nstarts &lt;- ends - r$lengths + 1\nrects &lt;- tibble(\n  start_idx = starts,\n  end_idx   = ends,\n  is_missing = r$values\n) |&gt;\n  filter(is_missing) |&gt;\n  transmute(\n    xmin = full$year[start_idx] - 0.5,\n    xmax = full$year[end_idx]   + 0.5\n  )\n\npct_miss &lt;- mean(full$is_missing)\n\nggplot(full, aes(x = year, y = value)) +\n  geom_rect(data = rects,\n            aes(xmin = xmin, xmax = xmax, ymin = -Inf, ymax = Inf),\n            inherit.aes = FALSE, fill = \"grey85\") +\n  geom_line(na.rm = TRUE) +\n  geom_point(size = 1, na.rm = TRUE) +\n  labs(\n    title    = \"Poland â€” GDP per Capita (constant) 1960â€“2023\",\n    subtitle = glue(\"Missing years shaded ({percent(pct_miss)} of window, 1960-1990)\"),\n    x = \"Year\",\n    y = \"GDP per Capita (constant)\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(panel.grid.minor = element_blank())\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Create a folder for processed data if it doesnâ€™t exist\nif (!dir.exists(\"./data-gathering/data/processed\")) {\n  dir.create(\"./data-gathering/data/processed\", recursive = TRUE)\n}\n\n# Save the cleaned, filtered dataset\nwrite_csv(range_filtered_data, \"./data-gathering/data/processed/range_filtered_data.csv\")\n\n# Optional: also save RDS (faster, keeps types)\nsaveRDS(range_filtered_data, \"./data-gathering/data/processed/range_filtered_data.rds\")",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "3Â  Results",
    "section": "",
    "text": "3.1 Global fertility trajectories\nCode\nfertility_long &lt;- master_long |&gt;\n  filter(\n    variable == \"fertility_rate\",\n    year &gt;= 1960,\n    year &lt;= end_year\n  ) |&gt;\n  left_join(country_lookup, by = \"country\")\n\nggplot(fertility_long, aes(x = year, y = value)) +\n  # replacement line\n  geom_hline(\n    yintercept = 2.1,\n    linetype   = \"dashed\",\n    color      = \"grey40\"\n  ) +\n  geom_line(color = \"#2c7fb8\", linewidth = 0.7) +\n  facet_wrap(~ country_name, ncol = 4) +\n  scale_y_continuous(\n    \"Fertility rate (births per woman)\",\n    limits = c(0, NA)\n  ) +\n  scale_x_continuous(\n    \"Year\",\n    breaks = seq(1960, 2020, by = 20)\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    strip.text = element_text(face = \"bold\"),\n    plot.title = element_text(face = \"bold\", size = 16),\n    panel.grid.minor = element_blank()\n  ) +\n  labs(\n    title = \"Fertility has declined across all selected countries\",\n    subtitle = \"Dashed line shows the replacement level of 2.1 births per woman\"\n  )\n\n\n\n\n\nFertility rate trajectories (births per woman) for 13 selected countries. The dashed line marks the replacement level of 2.1 births per woman.\n!ADD DESCRIPTION HERE!\nCode\nfertility_data &lt;- master_long |&gt;\n  filter(\n    variable == \"fertility_rate\",\n    year &gt;= 1960,\n    year &lt;= end_year\n  ) |&gt;\n  left_join(country_lookup, by = \"country\")\n\n# compute average fertility over the entire period\ncountry_order &lt;- fertility_data |&gt;\n  group_by(country_name) |&gt;\n  summarize(avg_fertility = mean(value, na.rm = TRUE)) |&gt;\n  arrange(desc(avg_fertility)) |&gt;\n  pull(country_name)\n\nfertility_data &lt;- fertility_data |&gt;\n  mutate(\n    country_name = factor(country_name, levels = rev(country_order))\n  )\n\nggplot(fertility_data, aes(x = year, y = country_name, fill = value)) +\n  geom_tile() +\n  scale_x_continuous(\n    \"Year\",\n    breaks = seq(1960, 2020, by = 10),\n    expand = expansion(mult = c(0, 0))\n  ) +\n  scale_fill_viridis_c(\n    name = \"Births per\\nwoman\",\n    option = \"magma\",\n    direction = -1\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    panel.grid = element_blank(),\n    axis.title.y = element_blank(),\n    axis.text.y  = element_text(face = \"bold\"),\n    plot.title   = element_text(size = 16, face = \"bold\")\n  ) +\n  labs(\n    title = \"Fertility is converging across countries over time\"\n  )\n\n\n\n\n\nFertility rates across countries and years, with countries ordered by average fertility.\n!ADD DESCRIPTION!\nCode\ngdp_long &lt;- master_long |&gt;\n  filter(\n    variable == \"gdp_capita_const\",\n    year &gt;= 1960,\n    year &lt;= end_year\n  ) |&gt;\n  left_join(country_lookup, by = \"country\")\n\nggplot(gdp_long, aes(x = year, y = value)) +\n  geom_line(color = \"#1b9e77\", linewidth = 0.7) +\n  facet_wrap(~ country_name, ncol = 4) +\n  scale_y_log10(\n    \"Constant GDP per capita (log scale)\",\n    labels = scales::label_number(accuracy = 1, big.mark = \",\")\n  ) +\n  scale_x_continuous(\n    \"Year\",\n    breaks = seq(1960, 2020, by = 20)\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    strip.text   = element_text(face = \"bold\"),\n    plot.title   = element_text(face = \"bold\", size = 16),\n    panel.grid.minor = element_blank()\n  ) +\n  labs(\n    title = \"GDP per capita has risen across all selected countries\",\n    subtitle = \"Y-axis is on a logarithmic scale to make relative growth comparable.\"\n  )\n\n\n\n\n\nConstant GDP per capita (log scale) for 13 selected countries.\nCode\ngdp_long &lt;- master_long |&gt;\n  filter(\n    variable == \"gdp_capita_const\",\n    year &gt;= 1960,\n    year &lt;= end_year\n  ) |&gt;\n  left_join(country_lookup, by = \"country\")\n\nggplot(gdp_long, aes(x = year, y = value)) +\n  geom_line(color = \"#1b9e77\", linewidth = 0.7) +\n  facet_wrap(~ country_name, ncol = 4, scales = \"free_y\") +\n  scale_y_continuous(\n    \"Constant GDP per capita (USD)\",\n    labels = scales::label_number(accuracy = 1, big.mark = \",\")\n  ) +\n  scale_x_continuous(\n    \"Year\",\n    breaks = seq(1960, 2020, by = 20)\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    strip.text       = element_text(face = \"bold\"),\n    plot.title       = element_text(face = \"bold\", size = 16),\n    panel.grid.minor = element_blank()\n  ) +\n  labs(\n    title = \"GDP per capita over time\",\n  )\n\n\n\n\n\nConstant GDP per capita (linear scale) for 13 selected countries.\nCode\n#| label: fert-gdp-facets\n#| fig-cap: \"Relationship between fertility and GDP per capita, one panel per country.\"\n\nfert_gdp &lt;- master_long |&gt;\n  filter(\n    variable %in% c(\"fertility_rate\", \"gdp_capita_const\"),\n    year &gt;= 1960,\n    year &lt;= end_year\n  ) |&gt;\n  select(country, year, variable, value) |&gt;\n  tidyr::pivot_wider(names_from = variable, values_from = value) |&gt;\n  left_join(country_lookup, by = \"country\") |&gt;\n  filter(!is.na(fertility_rate), !is.na(gdp_capita_const))\n\nggplot(fert_gdp, aes(x = gdp_capita_const, y = fertility_rate)) +\n  geom_point(alpha = 0.4, color = \"#2c7fb8\", size = 1) +\n  geom_smooth(method = \"loess\", se = FALSE, linewidth = 0.7, color = \"#d95f02\") +\n  facet_wrap(~ country_name, scales = \"free\") +\n  scale_x_log10(\n    \"Constant GDP per capita (log scale)\",\n    labels = scales::label_number(scale_cut = scales::cut_si(\"\"))\n  ) +\n  scale_y_continuous(\"Fertility rate (births per woman)\") +\n  theme_minimal(base_size = 12) +\n  theme(\n    strip.text = element_text(face = \"bold\"),\n    plot.title = element_text(size = 16, face = \"bold\")\n  ) +\n  labs(\n    title = \"Fertility declines as GDP per capita rises\",\n    subtitle = \"Each panel shows a country's trajectory across 1960â€“2023\"\n  )\nCode\ngapminder_data &lt;- master_long |&gt;\n  filter(\n    variable %in% c(\"fertility_rate\", \"gdp_capita_const\", \"total_population\"),\n    year &gt;= 1960,\n    year &lt;= end_year\n  ) |&gt;\n  select(country, year, variable, value) |&gt;\n  tidyr::pivot_wider(\n    names_from = variable,\n    values_from = value\n  ) |&gt;\n  left_join(country_lookup, by = \"country\") |&gt;\n  # keep rows with both fertility & GDP present\n  filter(!is.na(fertility_rate), !is.na(gdp_capita_const))\nCode\n# #| label: gapminder-fertility-gdp\n# #| eval: true\n# #| message: false\n# #| warning: false\n# \n# # base plot\n# p_gapminder &lt;- ggplot(\n#   gapminder_data,\n#   aes(\n#     x     = gdp_capita_const,\n#     y     = fertility_rate,\n#     size  = total_population / 1e6,   # millions\n#     color = region\n#   )\n# ) +\n#   geom_point(alpha = 0.8) +\n#   scale_x_log10(\n#     \"Constant GDP per capita (log scale)\",\n#     labels = scales::label_number(scale_cut = scales::cut_si(\"\"))\n#   ) +\n#   scale_y_continuous(\n#     \"Fertility rate (births per woman)\",\n#     limits = c(0, NA)\n#   ) +\n#   scale_size_continuous(\n#     name = \"Population (millions)\",\n#     range = c(2, 10),\n#     guide = \"legend\"\n#   ) +\n#   theme_minimal(base_size = 12) +\n#   theme(\n#     legend.position = \"right\",\n#     plot.title      = element_text(size = 16, face = \"bold\"),\n#     plot.subtitle   = element_text(size = 11)\n#   ) +\n#   labs(\n#     title    = \"Fertility vs GDP per Capita Over Time\",\n#     subtitle = \"Year: {frame_time}\",\n#     color    = \"Region\"\n#   ) +\n#   transition_time(year) +\n#   ease_aes(\"linear\")\n# \n# # animate and save as GIF\n# anim &lt;- animate(\n#   p_gapminder,\n#   renderer = gifski_renderer(),\n#   width    = 800,\n#   height   = 600,\n#   res      = 120,\n#   fps      = 10,\n#   duration = 12    # seconds\n# )\n# \n# if (!dir.exists(\"figs\")) dir.create(\"figs\")\n# anim_save(\"figs/gapminder_fertility_gdp.gif\", animation = anim)\n! INTERPRET ALL GRAPHS, ADD TRIPLE HASHTAG TITLES!",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#global-fertility-trajectories",
    "href": "results.html#global-fertility-trajectories",
    "title": "3Â  Results",
    "section": "",
    "text": "3.1.1 Fertility vs female labor force participation\n\n\nCode\nfert_flfpr &lt;- master_long |&gt;\n  filter(\n    variable %in% c(\"fertility_rate\", \"flfpr\"),\n    year &gt;= 1990,              # FLFPR starts around 1990\n    year &lt;= end_year\n  ) |&gt;\n  select(country, year, variable, value) |&gt;\n  tidyr::pivot_wider(names_from = variable, values_from = value) |&gt;\n  left_join(country_lookup, by = \"country\") |&gt;\n  filter(!is.na(fertility_rate), !is.na(flfpr))\n\nggplot(\n  fert_flfpr,\n  aes(\n    x      = flfpr,\n    y      = fertility_rate,\n    group  = country_name\n  )\n) +\n  geom_path(aes(color = year), linewidth = 0.7, alpha = 0.8) +\n  geom_point(aes(color = year), size = 1.2, alpha = 0.8) +\n  scale_color_viridis_c(\n    name = \"Year\",\n    option = \"plasma\"\n  ) +\n  facet_wrap(~ country_name, scales = \"free\") +\n  scale_x_continuous(\"Female labor force participation rate (%)\") +\n  scale_y_continuous(\"Fertility rate (births per woman)\") +\n  theme_minimal(base_size = 12) +\n  theme(\n    strip.text   = element_text(face = \"bold\"),\n    plot.title   = element_text(size = 16, face = \"bold\"),\n    panel.grid.minor = element_blank()\n  ) +\n  labs(\n    title    = \"As female labor force participation rises, fertility often falls\",\n    subtitle = \"Each panel shows a country's trajectory since 1990, with color indicating year\"\n  )\n\n\n\n\n\nRelationship between fertility and female labor force participation, with time evolution shown by connected points.\n\n\n\n\nDO WE KEEP THIS?",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>Results</span>"
    ]
  }
]